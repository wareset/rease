/* eslint-disable */
function n(){}var t,u,i=1,e={},r=function(c,s){var o=Array,f=Object,a={},h=null,p=f.is||function(n,t){return n===t?0!==n||1/n==1/t:n!=n&&t!=t};function g(n){throw"@rease/signal: "+n}function b(){var n=this;if(n.g!==a&&0===n.l&&(n.t||n._.h===n._.h.n)){var t,u=n.i,i=n.x,e=!n.g,r=h;h=null,n.l++;for(var l,c=0;c<i.length&&((l=u[c]).c&&b.call(l.c),!(e=!p(i[c].v,l.v)));c++);if(e){t=n.c(n.o?function(n){for(var t,u=n.length,i=o(u),e=0;e<u;e++)i[e]=(t=n[e]).b?t.v.get():t.v;return i}(n.o):(h=n,null),n._.v),h=null;for(var s,f=i.length;f-- >0;)(s=i[f]).g===n.g||n.o?s.v=u[f].v:(u.splice(f,1),i.splice(f,1)[0].u())}if(n.g=a,n.t=!1,n.l--,h=r,e){var v=n._,g=v.o;I(v,g?g(t,v.v):t)}}}function _(n,t){n.l++;var u=t.w||(t.w=[]),i=t.s.subscribe(b,n);return n.l--,u.push(n),function(){u.splice(u.lastIndexOf(n),1),i()}}function d(t,u){if(t._!==u){var i=t.i.indexOf(u);i<0?(t.i.push(u),t.x.push({g:t.g,v:d,u:t._.h===t._.h.n?n:_(t,u)})):t.x[i].g=t.g}}function w(n){if(n)for(var t,u=n.length;u-- >0;)(t=n[u]).t||(t.t=!0,w(t._.w))}function y(n){n.v===y&&n.f.call(n.c,n.v=this.v)}function x(t){this.c&&function(t){for(var u,i=t.i,e=t.x,r=0,l=t._.h;r<e.length&&l!==l.n;r++)(u=e[r]).u===n&&(u.u=_(t,i[r]));t.t=!0,b.call(t)}(this.c),this.f&&(this.l=this.f(this.s)),y.call(this,t)}function O(){this.l&&this.l(this.s),this.c&&function(t){for(var u,i,e=t.x,r=e.length,l=t._.h;r-- >0&&l===l.n;)u=(i=e[r]).u,i.u=n,u()}(this.c)}function m(t){var u=n;function i(n){l.set(n)}function e(){var t=u;u=n,t.unsubscribe?t.unsubscribe():t()}var l=new r(void 0,{prepare:()=>(u=t.subscribe(i),e)});return l}function S(n){this.s._value=this.v=this.o(n,this.v)}function q(n){I(this,this.o(n,this.v))}function I(n,u){p(n.v,u)||(n.s._value=n.v=u,a={},w(n.w),t(n))}r=class ReaseSignal{constructor(n,t){var u,i={s:this,v:this._value=n,q:n,d:t&&!t.compute&&void 0!==t.defense?(this.defensed=!0,u=t.defense,function(n){p(n,u)||g("defense")}):null,c:t&&t.compute?(this.computed=!0,{_:null,g:null,t:!0,l:0,c:t.compute,i:[],x:[],o:t.observe}):null,h:{n:null,p:null},p:null,r:!0,n:null,f:t&&t.prepare?(this.prepared=!0,t.prepare):null,l:null,o:t&&t.capture?(this.captured=!0,t.capture):null,w:null};this._=function(n){return n===e?i:g("secure")},i.p=i.h.n=i.h.p=i.h,i.c&&(i.c._=i,i.c.o&&function(n){for(var t,u,i=n.o,r=i.length,l=o(r),c=0;c<r;c++)(u=null!=(t=i[c])&&"function"==typeof t.subscribe)&&(v(t)||(t=m(t)),d(n,t._(e))),l[c]={v:t,b:u};n.o=l}(i.c)),i.o&&t.captureInitial&&l(S,i,[n])}get(){var t=this._(e),u=h;h=null,u&&d(u,t);var i,r=t.h===t.h.n&&(t.c||t.f)?this.subscribe(n):t.c&&void((i=t.c).g!==a&&0===i.l&&i.t&&l(b,i)),c=t.v;return r&&r(),h=u,c}set(n,t){var u=this._(e);return u.c?g("computed"):u.d&&u.d(t),u.o?l(q,u,[n]):I(u,n),this}subscribe(t,u){var i=this._(e),r={n:null,p:null,v:y,f:t,c:u};return i.p=(r.p=(r.n=i.p.n).p).n=r.n.p=r,l(r.n===r.p&&(i.c||i.f)?x:y,i,[r]),function(){r&&(r.p.n=r.n,r.n.p=r.p,r.f=n,r=null,i.h===i.h.n&&(i.c||i.l)&&l(O,i))}}toString(...n){var t=this.get();return null!=t&&t.toString?t.toString.apply(t,n):""+t}valueOf(...n){var t=this.get();return null!=t&&t.valueOf?t.valueOf.apply(t,n):t}toJSON(...n){var t=this.get();return null!=t&&t.toJSON?t.toJSON.apply(t,n):t}};var J=r.prototype;f.defineProperty(J,"$",{get:J.get,set:J.set}),(u=new r({f:n})._(e)).s.subscribe((function(n){n.f.apply(n.c,n.a)})),i=null;var N=0;return t=function(n){if(n.r)if(++N>4e4&&g("looping"),n.n=null,n.r=!1,i)i=i.n=n;else{i=n;for(var t;n;n=n.n){if(!p(n.q,n.q=t=n.v))for(var u=n.h,e=n.p=u;(e=n.p.n)!==u;)n.c&&b.call(n.c),p(t,n.v)?p((n.p=e).v,t)||e.f.call(e.c,e.v=t):(n.q=t=n.v,n.p=u);n.r=!0}i=null,N=0}},new r(c,s)};function l(n,e,r){i?n.apply(e,r):(u.v={f:n,c:e,a:r},t(u))}function c(){this[0]=this[0].apply(this[1],this[2])}function s(n){return function(...t){return l(c,t=[n,this,t]),t[0]}}function o(n,t){return new r(n,t)}function f(n,t,u){return new r(u,{compute:t,observe:n})}function a(t,u,i){return new r(void 0,{compute:u,observe:t}).subscribe(i||n)}function v(n){return n instanceof r}function h(n){return n instanceof r&&!!n._(e).c}function p(n){return n instanceof r&&!!n._(e).d}function g(n){return n instanceof r&&(!(n=n._(e)).c&&!n.d)}o(12,{captureInitial:!0,capture:(n,t)=>n});export{l as batch,s as batchify,f as computed,a as effect,v as isSignal,h as isSignalComputed,p as isSignalDefensed,g as isSignalManually,o as signal};
