/* eslint-disable */
function n(){}var t,e,i=1,r={},u=function(s,o){var f=Array,a=Object,p={},h=null,v=a.is||function(n,t){return n===t?0!==n||1/n==1/t:n!=n&&t!=t};function g(n){throw"@rease/signal: "+n}function b(){var n=this;if(n.g!==p&&0===n.l&&(n.t||n._.h===n._.h.n)){var t,e=n.i,i=n.x,r=!n.g,u=h;h=null,n.l++;for(var l,s=0;s<i.length&&((l=e[s]).c&&b.call(l.c),!(r=!v(i[s].v,l.v)));s++);if(r){t=n.c(n.o?function(n){for(var t,e=n.length,i=f(e),r=0;r<e;r++)i[r]=(t=n[r]).b?t.v.get():t.v;return i}(n.o):(h=n,null),n._.v),h=null;for(var c,o=i.length;o-- >0;)(c=i[o]).g===n.g||n.o?c.v=e[o].v:(e.splice(o,1),i.splice(o,1)[0].u())}if(n.g=p,n.t=!1,n.l--,h=u,r){var a=n._,g=a.o;J(a,g?g(t,a.v):t)}}}function d(n,t){n.l++;var e=t.w||(t.w=[]),i=t.s.subscribe(b,n);return n.l--,e.push(n),function(){e.splice(e.lastIndexOf(n),1),i()}}function _(t,e){if(t._!==e){var i=t.i.indexOf(e);i<0?(t.i.push(e),t.x.push({g:t.g,v:_,u:t._.h===t._.h.n?n:d(t,e)})):t.x[i].g=t.g}}function x(n){if(n)for(var t,e=n.length;e-- >0;)(t=n[e]).t||(t.t=!0,x(t._.w))}function w(n){n.v===w&&n.f.call(n.c,n.v=this.v)}function y(t){this.c&&function(t){for(var e,i=t.i,r=t.x,u=0,l=t._.h;u<r.length&&l!==l.n;u++)(e=r[u]).u===n&&(e.u=d(t,i[u]));t.t=!0,b.call(t)}(this.c),this.f&&(this.l=this.f(this.s)),w.call(this,t)}function S(){this.l&&this.l(this.s),this.c&&function(t){for(var e,i,r=t.x,u=r.length,l=t._.h;u-- >0&&l===l.n;)e=(i=r[u]).u,i.u=n,e()}(this.c)}function m(t){var e=n;function i(n){l.set(n)}function r(){var t=e;e=n,t.unsubscribe?t.unsubscribe():t()}var l=new u(void 0,{prepare:()=>(e=t.subscribe(i),r)});return l}function O(n){this.s._value=this.v=this.o(n,this.v)}function q(n){J(this,this.o(n,this.v))}function J(n,e){v(n.v,e)||(n.s._value=n.v=e,p={},x(n.w),t(n))}u=class ReaseSignal{constructor(n,t){var e,i={s:this,v:this._value=n,q:n,d:t&&!t.compute&&void 0!==t.defense?(this.defensed=!0,e=t.defense,function(n){v(n,e)||g("defense")}):null,c:t&&t.compute?(this.computed=!0,{_:null,g:null,t:!0,l:0,c:t.compute,i:[],x:[],o:t.observe}):null,h:{n:null,p:null},p:null,r:!0,n:null,f:t&&t.prepare?(this.prepared=!0,t.prepare):null,l:null,o:t&&t.capture?(this.captured=!0,t.capture):null,w:null};this._=function(n){return n===r?i:g("secure")},i.p=i.h.n=i.h.p=i.h,i.c&&(i.c._=i,i.c.o&&function(n){for(var t,e,i=n.o,u=i.length,l=f(u),s=0;s<u;s++)(e=null!=(t=i[s])&&"function"==typeof t.subscribe)&&(c(t)||(t=m(t)),_(n,t._(r))),l[s]={v:t,b:e};n.o=l}(i.c)),i.o&&l(O,i,[n])}get(){var t=this._(r),e=h;h=null,e&&_(e,t);var i,u=t.h===t.h.n&&(t.c||t.f)?this.subscribe(n):t.c&&void((i=t.c).g!==p&&0===i.l&&i.t&&l(b,i)),s=t.v;return u&&u(),h=e,s}set(n,t){var e=this._(r);return e.c?g("computed"):e.d&&e.d(t),e.o?l(q,e,[n]):J(e,n),this}subscribe(t,e){var i=this._(r),u={n:null,p:null,v:w,f:t,c:e};return i.p=(u.p=(u.n=i.p.n).p).n=u.n.p=u,l(u.n===u.p&&(i.c||i.f)?y:w,i,[u]),function(){u&&(u.p.n=u.n,u.n.p=u.p,u.f=n,u=null,i.h===i.h.n&&(i.c||i.l)&&l(S,i))}}toString(...n){var t=this.get();return null!=t&&t.toString?t.toString.apply(t,n):""+t}valueOf(...n){var t=this.get();return null!=t&&t.valueOf?t.valueOf.apply(t,n):t}toJSON(...n){var t=this.get();return null!=t&&t.toJSON?t.toJSON.apply(t,n):t}};var N=u.prototype;a.defineProperty(N,"$",{get:N.get,set:N.set}),(e=new u({f:n})._(r)).s.subscribe((function(n){n.f.apply(n.c,n.a)})),i=null;var j=0;return t=function(n){if(n.r)if(++j>4e4&&g("looping"),n.n=null,n.r=!1,i)i=i.n=n;else{i=n;for(var t;n;n=n.n){if(!v(n.q,n.q=t=n.v))for(var e=n.h,r=n.p=e;(r=n.p.n)!==e;)n.c&&b.call(n.c),v(t,n.v)?v((n.p=r).v,t)||r.f.call(r.c,r.v=t):(n.q=t=n.v,n.p=e);n.r=!0}i=null,j=0}},new u(s,o)};function l(n,r,u){i?n.apply(r,u):(e.v={f:n,c:r,a:u},t(e))}function s(){this[0]=this[0].apply(this[1],this[2])}function c(n){return n instanceof u}exports.batch=l,exports.batchify=function(n){return function(...t){return l(s,t=[n,this,t]),t[0]}},exports.computed=function(n,t,e){return new u(e,{compute:t,observe:n})},exports.effect=function(t,e,i){return new u(void 0,{compute:e,observe:t}).subscribe(i||n)},exports.isSignal=c,exports.isSignalComputed=function(n){return n instanceof u&&!!n._(r).c},exports.isSignalDefensed=function(n){return n instanceof u&&!!n._(r).d},exports.isSignalManually=function(n){return n instanceof u&&(!(n=n._(r)).c&&!n.d)},exports.signal=function(n,t){return new u(n,t)};
